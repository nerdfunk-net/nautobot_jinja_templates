{% macro set(interface,config_context) %}
{% set channelgroup = interface["lag"]["name"].split('Port-channel')[1] %}
{% for tag in interface.tags %}
{%   if 'channelmode_on' in tag.slug %}
{%     set found = true %}
 channel-group{{channelgroup}} mode on
{%   elif 'channelmode_active' %}
{%     set found = true %}
 channel-group{{channelgroup}} mode active
{%   elif 'channelmode_passive' %}
{%     set found = true %}
 channel-group{{channelgroup}} mode passive
{%   endif %}
{% endfor %}
{% found | config_context["default"]["channel-mode"] %}
 channel-group{{channelgroup}} mode {{ found }}
{% endif %}
{% endmacro %}